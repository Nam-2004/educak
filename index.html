<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduQuiz - Big Data HUBT</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2ecc71;
            --danger-color: #e74c3c;
            --info-color: #f39c12;
            --background-light: #f4f7f6;
            --background-card: #ffffff;
            --text-dark: #2c3e50;
            --text-medium: #34495e;
            --text-light: #7f8c8d;
            --border-color: #e0e0e0;
            --shadow-light: 0 4px 15px rgba(0, 0, 0, 0.08);
            --shadow-hover: 0 6px 20px rgba(0, 0, 0, 0.12);
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--background-light);
            color: var(--text-dark);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            background-color: var(--background-card);
            padding: 30px;
            border-radius: 12px;
            box-shadow: var(--shadow-light);
            max-width: 850px;
            width: 100%;
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
            min-height: 450px;
            box-sizing: border-box;
            position: relative;
        }

        h1 {
            font-family: 'Poppins', sans-serif;
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            font-weight: 600;
        }

        .quiz-section {
            margin-bottom: 25px;
            padding: 25px;
            border: 1px solid var(--border-color);
            border-radius: 10px;
            background-color: #fdfdfd;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            transition: all 0.3s ease-in-out;
        }

        .quiz-section h3 {
            font-family: 'Poppins', sans-serif;
            color: var(--text-medium);
            margin-top: 0;
            margin-bottom: 25px;
            font-size: 1.35em;
            text-align: center;
            font-weight: 600;
        }

        .options label {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding: 16px 20px;
            background-color: #ebf5f9; /* Lighter blue */
            border: 1px solid #cce7f5; /* Lighter blue border */
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease, border-color 0.3s ease, transform 0.2s ease;
            font-size: 1.05em;
            position: relative;
        }

        .options label:hover:not(.disabled) {
            background-color: #dbeaf0; /* Slightly darker on hover */
            border-color: #b3d9ec;
            transform: translateY(-2px);
        }

        .options input[type="radio"] {
            margin-right: 15px;
            transform: scale(1.2);
            accent-color: var(--primary-color); /* Custom accent color for radio button */
        }

        .options label.correct-answer {
            background-color: #e6ffe6; /* Light green */
            border-color: var(--secondary-color);
        }

        .options label.incorrect-answer {
            background-color: #ffe6e6; /* Light red */
            border-color: var(--danger-color);
        }

        .options label.disabled {
            cursor: not-allowed;
            opacity: 0.8;
        }

        .feedback {
            margin-top: 20px;
            font-weight: bold;
            text-align: center;
            padding: 12px 15px;
            border-radius: 8px;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .feedback.correct {
            color: var(--secondary-color);
            background-color: #e6ffe6;
            border: 1px solid var(--secondary-color);
        }

        .feedback.incorrect {
            color: var(--danger-color);
            background-color: #ffe6e6;
            border: 1px solid var(--danger-color);
        }

        .navigation-controls {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
            gap: 20px;
        }

        .navigation-controls button, .action-controls button, #startQuizBtn, #viewResultsBtn {
            background-color: var(--primary-color);
            color: white;
            padding: 14px 28px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            flex-grow: 1;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .navigation-controls button:hover:not(:disabled), .action-controls button:hover:not(:disabled), #startQuizBtn:hover, #viewResultsBtn:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
        }

        .navigation-controls button:disabled, .action-controls button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .action-controls {
            text-align: center;
            margin-top: 30px;
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .owner-info {
            margin-top: 40px;
            text-align: center;
            font-size: 0.9em;
            color: var(--text-light);
            padding: 10px;
        }

        .quiz-start-screen, .quiz-results-screen {
            text-align: center;
            padding: 50px 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 300px;
        }

        .quiz-start-screen h2, .quiz-results-screen h2 {
            font-family: 'Poppins', sans-serif;
            color: var(--text-dark);
            margin-bottom: 25px;
            font-size: 2em;
        }

        .quiz-start-screen p, .quiz-results-screen p {
            font-size: 1.1em;
            color: var(--text-medium);
            margin-bottom: 30px;
        }

        #startQuizBtn, #viewResultsBtn {
            padding: 15px 40px;
            font-size: 1.2em;
            background-color: var(--secondary-color);
        }
        #startQuizBtn:hover, #viewResultsBtn:hover {
            background-color: #27ae60;
        }

        .result-summary {
            margin-top: 30px;
            font-size: 1.2em;
            font-weight: bold;
            color: var(--text-dark);
        }
        .result-summary p {
            margin: 10px 0;
        }
        .result-summary .correct-count {
            color: var(--secondary-color);
        }
        .result-summary .incorrect-count {
            color: var(--danger-color);
        }
        .result-summary .total-count {
            color: var(--primary-color);
        }

        .timer-display {
            position: absolute;
            top: 20px;
            right: 20px;
            background-color: var(--info-color);
            color: white;
            padding: 8px 15px;
            border-radius: 5px;
            font-weight: bold;
            font-size: 0.9em;
            display: none; /* Hidden by default */
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>EduQuiz - Big Data HUBT (2TC) - Update</h1>
        <div id="quizContent">
            <div class="quiz-start-screen" id="startScreen">
                <h2>Chào mừng bạn đến với bài kiểm tra Big Data!</h2>
                <p>Nhấn "Bắt đầu bài kiểm tra" để bắt đầu ôn luyện. Các câu hỏi sẽ tự động chuyển sau 3 giây khi bạn chọn đáp án.</p>
                <button id="startQuizBtn">Bắt đầu bài kiểm tra</button>
            </div>

            <div id="questionArea" style="display: none;">
                <div id="questionContainer">
                    </div>
                <div class="navigation-controls">
                    <button id="prevBtn" onclick="showPrevQuestion()" disabled><i class="fas fa-arrow-left"></i> Câu trước</button>
                    <button id="nextBtn" onclick="showNextQuestion()">Câu tiếp theo <i class="fas fa-arrow-right"></i></button>
                </div>
            </div>

            <div class="quiz-results-screen" id="resultsScreen" style="display: none;">
                <h2>Kết quả bài kiểm tra</h2>
                <div class="result-summary">
                    <p>Tổng số câu hỏi: <span id="totalQuestionsResult" class="total-count"></span></p>
                    <p>Số câu đúng: <span id="correctAnswersCount" class="correct-count"></span></p>
                    <p>Số câu sai: <span id="incorrectAnswersCount" class="incorrect-count"></span></p>
                </div>
                <div class="action-controls" style="margin-top: 40px;">
                    <button onclick="shuffleQuestionsAndReset()"><i class="fas fa-random"></i> Đảo câu hỏi và làm lại</button>
                    <button onclick="resetQuiz()"><i class="fas fa-redo-alt"></i> Làm lại bài kiểm tra (nguyên gốc)</button>
                </div>
            </div>
        </div>
    </div>

    <div class="owner-info">
        <p>&copy; 2024 EduQuiz. Người sở hữu trang: Phan Minh Nam</p>
    </div>

    <script>
        const quizData = [
            {
                question: "Dữ liệu của Big Data là loại nào?",
                options: ["Structured Data", "Semi-Structured Data", "Unstructured Data", "Tất cả"],
                correctAnswer: "Tất cả",
                source: [1, 2]
            },
            {
                question: "Đặc trưng nào không phải của Big Data?",
                options: ["Volume", "Variety", "Vision", "Velocity"],
                correctAnswer: "Vision",
                source: [3]
            },
            {
                question: "NoSQL là?",
                options: ["Database", "1eld", "Document", "Collection"],
                correctAnswer: "Database",
                source: [4]
            },
            {
                question: "Mục tiêu của NoSQL là gì?",
                options: [
                    "NoSQL cung cấp một giải pháp thay thế cho cơ sở dữ liệu SQL để lưu trữ dữ liệu dạng văn bản.",
                    "Cơ sở dữ liệu NoSQL cho phép lưu trữ dữ liệu không có cấu trúc.",
                    "NoSQL không thích hợp để lưu trữ dữ liệu có cấu trúc.",
                    "NoSQL là một định dạng dữ liệu mới để lưu trữ các tập dữ liệu lớn."
                ],
                correctAnswer: "NoSQL là một định dạng dữ liệu mới để lưu trữ các tập dữ liệu lớn.",
                source: [5, 6, 7, 8]
            },
            {
                question: "Cloudera phát triển công cụ nào?",
                options: ["HCatalog", "Hbase", "Imphala", "Oozie"],
                correctAnswer: "Hbase",
                source: [9]
            },
            {
                question: "Loại nào không phải là CSDL NoSQL?",
                options: ["SQL Server", "MongoDB", "Cassandra", "Không có"],
                correctAnswer: "SQL Server",
                source: [10, 11]
            },
            {
                question: "Đâu là một kiểu của CSDL NOSQL",
                options: ["SQL", "Document databases", "JSON", "Tất cả"],
                correctAnswer: "Document databases",
                source: []
            },
            {
                question: "Chọn đúng 5 đặc trưng cho Big Data?",
                options: ["Volume, Velocity, Variety, Veracity, Value", "Volume, Videos, Velocity, Variability, Value", "Volume, Variability, Veracity, Visualization, Value", "Volume, Velocity, Veracity, Visualization, Value"],
                correctAnswer: "Volume, Velocity, Variety, Veracity, Value",
                source: [12]
            },
            {
                question: "Velocity (Tốc độ) là đặc trưng nói về?",
                options: ["Tốc độ gia tăng khối lượng dữ liệu lớn", "Tốc độ cập nhật dữ liệu lớn", "Tốc độ xử lý dữ liệu lớn", "Tốc độ lưu trữ dữ liệu lớn"],
                correctAnswer: "Tốc độ xử lý dữ liệu lớn",
                source: [13]
            },
            {
                question: "Variety (Tính đa dạng) là đặc trưng về?",
                options: ["Kiểu dữ liệu thu thập", "Kiểu nội dung dữ liệu", "Nguồn thu thập dữ liệu", "Phương thức xử lý dữ liệu"],
                correctAnswer: "Kiểu dữ liệu thu thập",
                source: [14]
            },
            {
                question: "Đặc trưng quan trọng nhất của Big Data?",
                options: ["Khối lượng", "Tính đa dạng", "Tốc độ", "Tất cả"],
                correctAnswer: "Tất cả",
                source: [15]
            },
            {
                question: "Đâu là đặc trưng quyết việc triển khai Dữ liệu lớn?",
                options: ["Khối lượng", "Giá trị", "Tốc Độ", "Tính đa dạng"],
                correctAnswer: "Giá trị",
                source: [16, 17]
            },
            {
                question: "Tích hợp dữ liệu là quá trình?",
                options: [
                    "Kết hợp các dữ liệu không đồng nhất từ nhiều nguồn khác nhau",
                    "Sao chép dữ liệu vào CSDL hệ thống để tiến hành phân tích",
                    "Làm sạch các dữ liệu thu thập được từ các hệ thống thành phần",
                    "Tăng giá trị từ các tài nguyên dữ liệu đang lưu trữ phân tán"
                ],
                correctAnswer: "Kết hợp các dữ liệu không đồng nhất từ nhiều nguồn khác nhau",
                source: [18]
            },
            {
                question: "Thuật ngữ Thuật ngữ Dữ liệu lớn ra đời năm nào?",
                options: ["1997", "2000", "1998", "1941"],
                correctAnswer: "1997",
                source: [19]
            },
            {
                question: "Các dạng thức khoa học dữ liệu của Jim Gray?",
                options: ["Thực nghiệm", "Lý thuyết", "Tính toán", "Tất cả các ý"],
                correctAnswer: "Tất cả các ý",
                source: [20]
            },
            {
                question: "Phát biểu nào không phải dạng thức nghiên cứu Khoa học dữ liệu của Jim Gray?",
                options: ["Khai thác dữ liệu", "Mô phỏng", "Tính toán", "Thực nghiệm"],
                correctAnswer: "Mô phỏng",
                source: [21]
            },
            {
                question: "Đâu không phải là phương thức xử lý dữ liệu lớn?",
                options: ["Thu thập (acquire)", "Đánh giá (reviews)", "Tổ chức (organize)", "Phân tích (analyze)"],
                correctAnswer: "Đánh giá (reviews)",
                source: [22, 23]
            },
            {
                question: "RDBMS là gì?",
                options: ["Relational Database Management System", "Relat Data Management System", "Relational Database Microsoft System", "Tất cả"],
                correctAnswer: "Relational Database Management System",
                source: [24]
            },
            {
                question: "Thị trường Big Data bao gồm?",
                options: ["Phần cứng", "Phần Mềm", "Tất cả", "Dịch vụ"],
                correctAnswer: "Tất cả",
                source: [25]
            },
            {
                question: "Nhược điểm của tích hợp dữ liệu theo phương pháp Tight Coupling?",
                options: ["Độ trễ", "Phản hồi truy vấn", "Phụ thuộc vào nguồn dữ liệu", "Tất cả"],
                correctAnswer: "Độ trễ",
                source: [26]
            },
            {
                question: "Nhược điểm của tích hợp dữ liệu theo phương pháp Loose Coupling?",
                options: ["Tất cả", "Chi phí cao", "Độ trễ", "Phụ thuộc mạng/băng thông"],
                correctAnswer: "Phụ thuộc mạng/băng thông",
                source: [27]
            },
            {
                question: "Công cụ nào hỗ trợ tốt NoSQL?",
                options: ["SAP Data Services", "Oracle Data Integrator", "SQL Server Integration Services", "Tất cả"],
                correctAnswer: "Tất cả",
                source: [28]
            },
            {
                question: "Công cụ tích hợp dữ liệu Boomi là của?",
                options: ["Dell", "IBM", "Microsoft", "SAP"],
                correctAnswer: "Dell",
                source: [29, 30]
            },
            {
                question: "Công cụ SQL Server Integrator do ai phát triển?",
                options: ["Oracle", "IBM", "Microsoft", "SAP"],
                correctAnswer: "Microsoft",
                source: [31]
            },
            {
                question: "SAP Data Service là công cụ để làm gì?",
                options: ["Lưu trữ dữ liệu", "Tích hợp dữ liệu", "Phân tích dữ liệu", "Tất cả"],
                correctAnswer: "Tích hợp dữ liệu",
                source: [32]
            },
            {
                question: "Hệ quản trị CSLD DynamoDB là kiểu nào?",
                options: ["Key value", "Wide Column based", "Document based", "Graph based"],
                correctAnswer: "Key value",
                source: [33]
            },
            {
                question: "Hệ quản trị CSLD MongoDB là kiểu nào?",
                options: ["Document based", "Key value", "Wide Column based", "Graph based"],
                correctAnswer: "Document based",
                source: [34]
            },
            {
                question: "Hệ quản trị CSLD Neo4J là kiểu nào?",
                options: ["Key value", "Wide Column based", "Document based", "Graph based"],
                correctAnswer: "Graph based",
                source: [35]
            },
            {
                question: "Hệ quản trị CSLD IBM Graph là kiểu nào?",
                options: ["Key value", "Document based", "Graph based", "Wide Column based"],
                correctAnswer: "Graph based",
                source: [36, 37]
            },
            {
                question: "Hệ quản trị CSLD Google Big Table là kiểu nào?",
                options: ["Key value", "Wide Column based", "Document based", "Graph based"],
                correctAnswer: "Wide Column based",
                source: [38]
            },
            {
                question: "Đâu không phải là RDBMS?",
                options: ["IBM DB2", "MS SQL Server", "MS Access", "Cassandra"],
                correctAnswer: "Cassandra",
                source: [39]
            },
            {
                question: "Loại nào là dữ liệu Bán cấu trúc?",
                options: ["Tất cả", "JSON", "CSV", "XML"],
                correctAnswer: "Tất cả",
                source: [40]
            },
            {
                question: "Loại nào là dữ liệu Unstructured?",
                options: ["Video", "XML", "Table", "Tất cả"],
                correctAnswer: "Video",
                source: [41]
            },
            {
                question: "Yếu tố nào quyết định để sử dụng NoSQL",
                options: ["Tốc độ gia tăng CSDL", "Tính đa dạng của dữ liệu", "Tốc độ truy cập dữ liệu", "Tất cả"],
                correctAnswer: "Tất cả",
                source: []
            },
            {
                question: "CSDL nào không phải kiểu Key-Value:",
                options: ["MongoDB", "DynamoDB", "Redis", "Riak"],
                correctAnswer: "MongoDB",
                source: []
            },
            {
                question: "CSDL nào không phải kiểu Document:",
                options: ["MongoDB", "CouchDB", "Elasticsearch", "Riak"],
                correctAnswer: "Riak",
                source: []
            },
            {
                question: "CSDL nào không phải kiểu Graph:",
                options: ["InfoGrid", "Hbase", "In1niteGraph", "IBM Graph"],
                correctAnswer: "Hbase",
                source: []
            },
            {
                question: "CSDL nào không phải kiểu Wide-Column:",
                options: ["Hbase", "Cassandra", "Big Table", "Dex"],
                correctAnswer: "Dex",
                source: []
            },
            {
                question: "Ưu điểm của hệ thống HDFS là gì?",
                options: ["Lưu trữ phân tán, xử lý song song, khả năng chịu lỗi cao", "Lưu trữ song song, xử lý phân tán, tính sẵn sàng cao", "Xử lý phân tán song song, khả năng chịu lỗi chấp nhận sai sót", "Tất cả"],
                correctAnswer: "Lưu trữ phân tán, xử lý song song, khả năng chịu lỗi cao",
                source: [43]
            },
            {
                question: "Ưu điểm của DFS là gì?",
                options: [
                    "Hệ thống lưu trữ song song nên tránh được ảnh hưởng khi một máy chủ hoặc bộ nhớ bị lỗi",
                    "Hệ thống được sao lưu tại Server thứ hai nên đảm bảo việc cung cấp dữ liệu",
                    "Khi một máy chủ hoặc bộ nhớ bị lỗi, hệ thống tệp phân tán vẫn đảm bảo có thể cung cấp dữ liệu ổn định",
                    "Tất cả"
                ],
                correctAnswer: "Khi một máy chủ hoặc bộ nhớ bị lỗi, hệ thống tệp phân tán vẫn đảm bảo có thể cung cấp dữ liệu ổn định",
                source: [44, 45]
            },
            {
                question: "Ưu điểm của công nghệ Cluster",
                options: ["Tất cả", "Hiệu quả chi phí", "Tính sẵn sàng cao", "Khả năng mở rộng linh hoạt"],
                correctAnswer: "Tất cả",
                source: []
            },
            {
                question: "Cluster node có mấy loại?",
                options: ["1", "2", "3", "4"],
                correctAnswer: "2",
                source: [46]
            },
            {
                question: "Nguồn của kiến trúc HDFS trong Hadoop có nguồn gốc là",
                options: ["Hệ thống tệp phân phối của Google", "Hệ thống tệp phân tán của Yahoo", "Hệ thống tệp phân tán của Facebook", "Hệ thống tệp phân tán Azure"],
                correctAnswer: "Hệ thống tệp phân phối của Google",
                source: []
            },
            {
                question: "Loại dữ liệu mà Hadoop có thể xử lý là",
                options: ["Structred (Có cấu trúc)", "Semi-structured (Bán cấu trúc)", "Unstructured (Không có cấu trúc)", "All of the above (Tất cả những điều trên)"],
                correctAnswer: "All of the above (Tất cả những điều trên)",
                source: []
            },
            {
                question: "YARN là viết tắt của",
                options: ["Yahoo's another resource name", "Yet another resource negotiator", "Yahoo's archived Resource names", "Yet another resource need."],
                correctAnswer: "Yet another resource negotiator",
                source: [47, 48]
            },
            {
                question: "Điều nào sau đây không phải là mục tiêu của HDFS?",
                options: ["Phát hiện lỗi và khôi phục", "Xử lý tập dữ liệu khổng lồ", "Ngăn chặn việc xóa dữ liệu", "Cung cấp băng thông mạng cao để di chuyển dữ liệu"],
                correctAnswer: "Ngăn chặn việc xóa dữ liệu",
                source: [49, 50]
            },
            {
                question: "Trong HDFS, các tệp không thể",
                options: ["Đọc", "Xóa", "Thực thi", "Lưu trữ"],
                correctAnswer: "Thực thi",
                source: []
            },
            {
                question: "So với RDBMS, Hadoop",
                options: ["Có tính toàn vẹn dữ liệu cao hơn.", "Có giao dịch ACID không", "Thích hợp để đọc và truy vấn nhanh", "Hoạt động tốt hơn trên dữ liệu phi cấu trúc và bán cấu trúc."],
                correctAnswer: "Hoạt động tốt hơn trên dữ liệu phi cấu trúc và bán cấu trúc.",
                source: [51, 52]
            },
            {
                question: "Vấn đề chính gặp phải khi đọc và ghi dữ liệu song song từ nhiều đĩa là gì?",
                options: ["Xử lý khối lượng lớn dữ liệu nhanh hơn.", "Kết hợp dữ liệu từ nhiều đĩa.", "Phần mềm cần thiết để thực hiện nhiệm vụ này là cực kỳ tốn kém.", "Phần cứng cần thiết để thực hiện tác vụ này là cực kỳ tốn kém."],
                correctAnswer: "Kết hợp dữ liệu từ nhiều đĩa.",
                source: [53, 54, 55, 56]
            },
            {
                question: "Tính năng định vị dữ liệu trong Hadoop có nghĩa là",
                options: ["lưu trữ cùng một dữ liệu trên nhiều nút.", "chuyển vị trí dữ liệu từ nút này sang nút khác.", "đồng định vị dữ liệu với các nút tính toán.", "Phân phối dữ liệu trên nhiều nút."],
                correctAnswer: "đồng định vị dữ liệu với các nút tính toán.",
                source: [57, 58, 59]
            },
            {
                question: "Các tệp HDFS được thiết kế cho",
                options: ["Nhiều người viết và sửa đổi ở các hiệu số tùy ý.", "Chỉ nối vào cuối tệp.", "Chỉ ghi thành tệp một lần.", "Truy cập dữ liệu có độ trễ thấp."],
                correctAnswer: "Chỉ nối vào cuối tệp.",
                source: [60, 61, 62]
            },
            {
                question: "Hệ thống Apache Hadoop được viết bằng ngôn ngữ nào?",
                options: ["C++", "Python", "Java", "Go"],
                correctAnswer: "Java",
                source: [63, 64]
            },
            {
                question: "Cái nào không phải là một trong đặc trưng 3Vs của dữ liệu lớn?",
                options: ["Vận tốc - Velocity", "Tính xác thực - Veracity", "Khối lượng - Volume", "Đa dạng - Variety"],
                correctAnswer: "Tính xác thực - Veracity",
                source: [65]
            },
            {
                question: "Điều nào sau đây đúng đối với Hadoop?",
                options: ["Đây là một khung phân tán.", "Thuật toán chính được sử dụng trong đó là Map Reduce.", "Nó chạy có thể thực thi trên hạ tầng Cloud Computing.", "Tất cả đều đúng"],
                correctAnswer: "Tất cả đều đúng",
                source: [66, 67, 68]
            },
            {
                question: "Loại nào sau đây lưu trữ dữ liệu?",
                options: ["Name node", "Data node", "Master node", "Không có"],
                correctAnswer: "Data node",
                source: [69]
            },
            {
                question: "Node nào sau đây quản lý các nút khác?",
                options: ["Name node", "Data node", "Slave node", "Tất cả"],
                correctAnswer: "Name node",
                source: [70]
            },
            {
                question: "Hadoop xử lý khối lượng lớn dữ liệu như thế nào?",
                options: [
                    "Hadoop sử dụng song song rất nhiều máy. Điều này tối ưu hóa việc xử lý dữ liệu.",
                    "Hadoop được thiết kế đặc biệt để xử lý lượng lớn dữ liệu bằng cách tận dụng phần cứng MPP.",
                    "Hadoop gửi mã đến dữ liệu thay vì gửi dữ liệu đến mã.",
                    "Hadoop sử dụng các kỹ thuật bộ nhớ đệm phức tạp trên NameNode để tăng tốc độ xử lý dữ liệu."
                ],
                correctAnswer: "Hadoop gửi mã đến dữ liệu thay vì gửi dữ liệu đến mã.",
                source: [71, 72, 73, 74]
            },
            {
                question: "MapReduce do công ty nào phát triển?",
                options: ["Apache", "Google", "IBM", "Amazon"],
                correctAnswer: "Google",
                source: [75, 76]
            },
            {
                question: "Dịch vụ đám mây nào hỗ trợ tốt cho Big Data?",
                options: ["Amazon AWS", "Google Cloud", "Tất cả", "Microsoft Azure"],
                correctAnswer: "Tất cả",
                source: [77]
            },
            {
                question: "Nhược điểm khi triển khai Big Data trên nền tảng Cloud Computing là?",
                options: ["Nhiều rủi ro cho hệ thống", "Không có ý đúng", "Tốc độ xử lý không đảm bảo", "Phân tích theo thời gian thực kém"],
                correctAnswer: "Không có ý đúng",
                source: [78]
            },
            {
                question: "Mô hình Điện toán đám mây IaaS?",
                options: ["Cơ sở hạ tầng dưới dạng dịch vụ", "Nền tảng dưới dạng dịch vụ", "Phần mềm dưới dạng dịch vụ", "Internet dưới dạng dịch vụ"],
                correctAnswer: "Cơ sở hạ tầng dưới dạng dịch vụ",
                source: [79]
            },
            {
                question: "Mô hình Điện toán đám mây PaaS?",
                options: ["Cơ sở hạ tầng dưới dạng dịch vụ", "Nền tảng dưới dạng dịch vụ", "Phần mềm dưới dạng dịch vụ", "Internet dưới dạng dịch vụ"],
                correctAnswer: "Nền tảng dưới dạng dịch vụ",
                source: [80]
            },
            {
                question: "Mô hình Điện toán đám mây SaaS?",
                options: ["Cơ sở hạ tầng dưới dạng dịch vụ", "Nền tảng dưới dạng dịch vụ", "Phần mềm dưới dạng dịch vụ", "Internet dưới dạng dịch vụ"],
                correctAnswer: "Phần mềm dưới dạng dịch vụ",
                source: [81, 82]
            },
            {
                question: "Lợi ích của Cloud Computing với Big Data là?",
                options: ["Triển khai hạ tầng nhanh chóng", "Phân tích theo thời gian thực", "Tối ưu chi phí duy trì hoạt động", "Tất cả"],
                correctAnswer: "Tất cả",
                source: [83]
            },
            {
                question: "Lợi ích vượt trội của Cloud Computing với Big Data là?",
                options: ["Hạn chế đầu tư máy móc", "Phân tích theo thời gian thực", "Tối ưu chi phí duy trì hoạt động", "Tất cả"],
                correctAnswer: "Phân tích theo thời gian thực",
                source: [84]
            },
            {
                question: "Dịch vụ lưu trữ dữ của Amazon - AWS là?",
                options: ["Amazon S3", "Amazon RDS", "Amazon Lambda", "EC2"],
                correctAnswer: "Amazon S3",
                source: [85]
            },
            {
                question: "Dịch vụ lưu trữ của Microsoft Azure là?",
                options: ["Virtual Machines", "Azure Function", "Azure Disk Storage", "Azure Cosmos DB"],
                correctAnswer: "Azure Disk Storage",
                source: [86]
            },
            {
                question: "Dịch vụ lưu trữ của Google Cloud Platfom là?",
                options: ["Google Driver", "Goolge Functions", "Google Cloud Storage", "Google Cloud Datastore"],
                correctAnswer: "Google Cloud Storage",
                source: [87]
            },
            {
                question: "Đám mây AWS cung cấp dịch vụ NoSQL Database",
                options: ["Amazon RDS", "Amazon EC2", "Amazon DynamoDB", "Amazon Container Service"],
                correctAnswer: "Amazon DynamoDB",
                source: [88]
            },
            {
                question: "Đám mây Microsoft Azure cung cấp dịch vụ NoSQL Database",
                options: ["Table Storage", "SQL DB", "Azure Functions", "Cloud Service"],
                correctAnswer: "Table Storage",
                source: []
            },
            {
                question: "Dịch vụ tích hợp dữ liệu trên đám mây trên Google Cloud Platform",
                options: ["Google Cloud Dataprep", "Google Cloud Data Fusion", "Google Data Catalog", "Google BigQuery"],
                correctAnswer: "Google Cloud Data Fusion",
                source: []
            },
            {
                question: "Dịch vụ thông minh giúp khái phá, làm sạch dữ liệu trên Google Cloud Platform",
                options: ["Goolge Functions", "Google BigQuery", "Google Cloud Dataprep", "Google Data Catalog"],
                correctAnswer: "Google Cloud Dataprep",
                source: [89]
            },
            {
                question: "Trên Google Cloud Platform dịch vụ nào quản lý CSDL NoQuery",
                options: ["Google Cloud Dataprep", "Google Data Catalog", "Google BigQuery", "Cloud Bigtable"],
                correctAnswer: "Cloud Bigtable",
                source: []
            },
            {
                question: "Trên Google Cloud Platform dịch vụ nào quản lý danh mục dữ liệu",
                options: ["Google Data Catalog", "Google Cloud Dataprep", "Google Data Catalog", "Google BigQuery"],
                correctAnswer: "Google Data Catalog",
                source: [90]
            },
            {
                question: "Trên Google Cloud Platform dịch vụ phân tích dữ liệu được cung cấp",
                options: ["Google Data Catalog", "Google BigQuery", "Google Cloud Dataprep", "Goolge Functions"],
                correctAnswer: "Google BigQuery",
                source: []
            },
            {
                question: "Nền tảng Cloudera hỗ trợ hệ CSDL quan hệ nào?",
                options: ["MySQL", "Oracle", "PostgreSQL", "Tất cả"],
                correctAnswer: "Tất cả",
                source: [91]
            },
            {
                question: "Hệ CSDL NoSQL trên nền tảng Cloudera là?",
                options: ["Apache Accumulo", "DynamoDB", "AppEngine Datastore", "Table Storage"],
                correctAnswer: "Apache Accumulo",
                source: [92]
            },
            {
                question: "Dịch vụ phân tích dữ liệu lớn Cloudera cung cấp là?",
                options: ["Hadoop", "BigQuery", "Elastic MapReduce", "Không có"],
                correctAnswer: "Elastic MapReduce",
                source: [93]
            },
            {
                question: "Cloudera Enterprise có thể được triển khai trên đám mây nào",
                options: ["Google Cloud", "Amazon AWS", "Tất cả", "Microsoft Azure"],
                correctAnswer: "Tất cả",
                source: []
            },
            {
                question: "Công cụ trên Google Cloud Platform chuyển đổi dữ liệu hỗ trợ quyết định",
                options: ["Google Cloud", "Google Data Catalog", "Google Data Studio", "Goolge Functions"],
                correctAnswer: "Google Data Studio",
                source: [94]
            },
            {
                question: "Mô hình chính dành cho Điện toán đám mây?",
                options: ["Cơ sở hạ tầng dưới dạng dịch vụ (IaaS)", "Tất cả", "Nền tảng dưới dạng dịch vụ (PaaS)", "Phần mềm dưới dạng dịch vụ (SaaS)"],
                correctAnswer: "Tất cả",
                source: [95]
            },
            {
                question: "Kiểu phân tích dữ liệu nào cho ta biết điều gì đã xảy ra?",
                options: ["Descriptive Analysis", "Diagnostic Analysis", "Predictive Analysis", "Prescriptive Analysis"],
                correctAnswer: "Descriptive Analysis",
                source: [96]
            },
            {
                question: "Kiểu phân tích dữ liệu nào chuẩn đoán lý do cho kết quả?",
                options: ["Descriptive Analysis", "Diagnostic Analysis", "Predictive Analysis", "Prescriptive Analysis"],
                correctAnswer: "Diagnostic Analysis",
                source: [97]
            },
            {
                question: "Kiểu phân tích dữ liệu nào dự đoán điều sẽ xảy ra?",
                options: ["Descriptive Analysis", "Diagnostic Analysis", "Predictive Analysis", "Prescriptive Analysis"],
                correctAnswer: "Predictive Analysis",
                source: [98]
            },
            {
                question: "Kiểu phân tích nào để hỗ trợ đưa ra quyết định?",
                options: ["Descriptive Analysis", "Diagnostic Analysis", "Predictive Analysis", "Prescriptive Analysis"],
                correctAnswer: "Prescriptive Analysis",
                source: [99]
            },
            {
                question: "Loại phân tích dữ liệu nào kết quả thu được cho ta biết điều gì đã xảy ra?",
                options: ["Phân tích mô tả", "Phân tích chuẩn đoán", "Phân tích dự đoán", "Phân tích đề xuất"],
                correctAnswer: "Phân tích mô tả",
                source: [100, 101]
            },
            {
                question: "Loại phân tích dữ liệu nào kết quả thu được cho ta biết tại sao điều đó xảy ra?",
                options: ["Phân tích mô tả", "Phân tích chuẩn đoán", "Phân tích dự đoán", "Phân tích đề xuất"],
                correctAnswer: "Phân tích chuẩn đoán",
                source: [102]
            },
            {
                question: "Loại phân tích dữ liệu nào kết quả thu được cho ta biết điều gì sẽ xảy ra?",
                options: ["Phân tích mô tả", "Phân tích chuẩn đoán", "Phân tích dự đoán", "Phân tích đề xuất"],
                correctAnswer: "Phân tích dự đoán",
                source: [103]
            },
            {
                question: "Loại phân tích dữ liệu nào kết quả thu được cho ta biết làm thể nào để nó xảy ra",
                options: ["Phân tích mô tả", "Phân tích chuẩn đoán", "Phân tích dự đoán", "Phân tích đề xuất"],
                correctAnswer: "Phân tích đề xuất",
                source: []
            },
            {
                question: "Mục tiêu đúng nhất của phân tích dữ liệu lớn là gì?",
                options: ["Biến dữ liệu thành thông tin chi tiết hữu ích", "Sắp xếp dữ liệu có ích để sử dụng", "Tạo ra các dữ liệu phù hợp nhất với hệ thống", "Xây dựng hệ thống để quản lý dữ liệu lớn"],
                correctAnswer: "Biến dữ liệu thành thông tin chi tiết hữu ích",
                source: [104]
            },
            {
                question: "Hoạt động của Map Reduce bao gồm:",
                options: ["Trộn & sắp xếp - Map - Reduce", "Map - Trộn & sắp xếp – Reduce", "Reduce - Map - Trộn & sắp xếp", "Sắp xếp - Trộn & Map – Reduce"],
                correctAnswer: "Map - Trộn & sắp xếp – Reduce",
                source: []
            },
            {
                question: "Phân tích chuẩn đoán sử dụng kỹ thuật nào?",
                options: ["Lấy mẫu dữ liệu", "Tương quan phân bổ", "Thu tập dữ liệu", "Khai phá dữ liệu"],
                correctAnswer: "Khai phá dữ liệu",
                source: [105, 106]
            },
            {
                question: "Phân tích chuẩn đoán sử dụng kỹ thuật nào?",
                options: ["Lấy mẫu mô tả", "Tương quan phân bổ", "Khôi phục dữ liệu", "Thu tập dữ liệu"],
                correctAnswer: "Khôi phục dữ liệu",
                source: [107]
            },
            {
                question: "Phân tích mô tả không phù hợp sử dụng để?",
                options: ["Xây dựng các báo cáo", "Lập bảng số liệu truyền thông", "Mô hình hoá dữ liệu quá khứ", "Phân tích tương quan"],
                correctAnswer: "Phân tích tương quan",
                source: [108]
            },
            {
                question: "Đâu là phân tích chuẩn đoán?",
                options: ["Mô tả tương quan dữ liệu", "Cung cấp cái nhinh sâu sắc về vấn đề", "Phân tích sự bất thường từ dữ liệu lưu trữ", "Mô hình hoá dữ liệu theo điều kiện"],
                correctAnswer: "Cung cấp cái nhinh sâu sắc về vấn đề",
                source: [109]
            },
            {
                question: "Trong MapReduce loại nào sau đây theo dõi quá trình tiêu thụ tài nguyên trên Cluster Node?",
                options: ["Name node", "Master node", "Single Master", "Slave node"],
                correctAnswer: "Master node",
                source: [110]
            },
            {
                question: "Trong MapReduce loại nào sau đây thực thi các tác vụ và cung cấp thông tin trạng thai tác vụ?",
                options: ["Name node", "Master node", "Single Master", "Slave node"],
                correctAnswer: "Slave node",
                source: [111]
            },
            {
                question: "Trong MapReduce loại nào sau đây được cung cấp task-status?",
                options: ["Name node", "JobTracker", "Single Master", "Slave node"],
                correctAnswer: "JobTracker",
                source: [112]
            },
            {
                question: "Mô hình MapReduce có thể chạy trên số lượng máy chủ?",
                options: ["Vài máy", "Hàng nghìn máy", "Hàng trăm máy", "Một máy chủ Master"],
                correctAnswer: "Hàng nghìn máy",
                source: [113]
            },
            {
                question: "Mô hình MapReduce thuộc lớp nào?",
                options: ["Lớp lưu trữ dữ liệu", "Lớp thu thập dữ liệu", "Lớp xử lý dữ liệu", "Lớp phân tích dữ liệu"],
                correctAnswer: "Lớp xử lý dữ liệu",
                source: [114]
            },
            {
                question: "Lợi ích từ Phân tích dữ liệu lớn là?",
                options: ["Tất cả", "Ra quyết định nhanh hơn, tốt hơn", "Giảm chi phí và tăng hiệu quả hoạt động", "Cải tiến theo định hướng dữ liệu cho thị trường"],
                correctAnswer: "Tất cả",
                source: [115]
            },
            {
                question: "Các ứng dụng phân tích dữ liệu lớn cho Lĩnh vực bán lẻ",
                options: ["Dự đoán hành vi mua sắm của khách hàng", "Xây dựng mô hình chi tiêu cho từng khách hàng", "Phân tích hành trình của khách hàng", "Tất cả"],
                correctAnswer: "Tất cả",
                source: []
            },
            {
                question: "Ứng dụng phân tích dữ liệu lớn hỗ trợ ngành Y tế",
                options: ["Tăng việc khai thác tối ưu hoá máy móc", "Tăng doanh thu từ phần mềm y tế", "Tăng tinh chính xác của chẩn đoán", "Tất cả"],
                correctAnswer: "Tăng tinh chính xác của chẩn đoán",
                source: [116]
            },
            {
                question: "Trong kiến trúc Apache Hadoop HDFS thuộc",
                options: ["Lớp lưu trữ", "Lớp truyền tải", "Lớp quản lý tài nguyên", "Lớp xử lý dữ liệu"],
                correctAnswer: "Lớp lưu trữ",
                source: [117]
            },
            {
                question: "Trong kiến trúc Apache Hadoop YARN là",
                options: ["Lớp lưu trữ", "Lớp truyền tải", "Lớp quản lý tài nguyên", "Lớp xử lý dữ liệu"],
                correctAnswer: "Lớp quản lý tài nguyên",
                source: []
            },
            {
                question: "Trong kiến trúc Apache Hadoop MapReduce là",
                options: ["Lớp lưu trữ", "Lớp truyền tải", "Lớp quản lý tài nguyên", "Lớp xử lý dữ liệu"],
                correctAnswer: "Lớp xử lý dữ liệu",
                source: []
            },
            {
                question: "Kiến trúc Hadoop hỗ trợ những ngôn ngữ nào",
                options: ["Java", "Tất cả", "C++", "Python"],
                correctAnswer: "Tất cả",
                source: [118]
            },
            {
                question: "Spark được Apache Software Foundation phát triển từ năm nào",
                options: ["1993", "2013", "2009", "2007"],
                correctAnswer: "2013",
                source: [119]
            },
            {
                question: "Apache Kafka là công cụ hỗ trợ?",
                options: ["Xử lý phân tán", "Lưu trữ phân tán", "Hệ quản trị CSDL", "Thu tập dữ liệu"],
                correctAnswer: "Xử lý phân tán",
                source: [120, 121]
            },
            {
                question: "Apache Storm là công cụ hỗ trợ?",
                options: ["Xử lý phân tán", "Lưu trữ phân tán", "Phân tích dữ liệu", "Thu tập dữ liệu"],
                correctAnswer: "Phân tích dữ liệu",
                source: [122]
            },
            {
                question: "Đâu không phải là chế độ hoạt động của Hadoop?",
                options: ["Chế độ phân phối giả", "Chế độ phân phối toàn cầu", "Chế độ độc lập", "Chế độ phân phối hoàn toàn"],
                correctAnswer: "Chế độ phân phối toàn cầu",
                source: [123]
            },
            {
                question: "Các tệp HDFS được thiết kế cho",
                options: ["Nhiều người viết và sửa đổi ở các hiệu số tùy ý.", "Chỉ nối vào cuối tệp", "Chỉ ghi thành tệp một lần.", "Truy cập dữ liệu có độ trễ thấp."],
                correctAnswer: "Chỉ nối vào cuối tệp",
                source: [124, 125, 126, 127]
            },
            {
                question: "Tính năng định vị dữ liệu trong Hadoop có nghĩa là",
                options: ["Lưu trữ cùng một dữ liệu trên nhiều nút.", "Chuyển vị trí dữ liệu từ nút này sang nút khác.", "Đồng định vị dữ liệu với các nút tính toán.", "Phân phối dữ liệu trên nhiều nút."],
                correctAnswer: "Đồng định vị dữ liệu với các nút tính toán.",
                source: [128, 129, 130]
            },
            {
                question: "Khó khăn khi đọc và ghi dữ liệu song song từ nhiều nguồn là gì?",
                options: ["Xử lý khối lượng lớn dữ liệu nhanh hơn.", "Kết hợp dữ liệu từ nhiều nguồn.", "Phần mềm cần thiết để thực hiện nhiệm vụ này là cực kỳ tốn kém.", "Phần cứng cần thiết để thực hiện tác vụ này là cực kỳ tốn kém."],
                correctAnswer: "Kết hợp dữ liệu từ nhiều nguồn.",
                source: [131, 132, 133, 134]
            },
            {
                question: "So với RDBMS, Hadoop",
                options: ["Có tính toàn vẹn dữ liệu cao hơn.", "Có giao dịch ACID không", "Nó thích hợp để đọc và viết nhiều lần", "Hoạt động tốt hơn trên dữ liệu phi cấu trúc và bán cấu trúc."],
                correctAnswer: "Hoạt động tốt hơn trên dữ liệu phi cấu trúc và bán cấu trúc.",
                source: [135, 136]
            },
            {
                question: "Yếu tố giới hạn hiện tại đối với kích thước của một cụm hadoop là",
                options: ["Nhiệt lượng dư thừa tạo ra trong trung tâm dữ liệu", "Giới hạn trên của băng thông mạng", "Giới hạn trên của RAM trong NameNode", "4000 datanode"],
                correctAnswer: "Giới hạn trên của RAM trong NameNode",
                source: [137]
            },
            {
                question: "Trong HDFS, các tệp không thể",
                options: ["Đọc", "Xoá", "Thực thi", "Lưu trữ"],
                correctAnswer: "Thực thi",
                source: []
            },
            {
                question: "Điều nào sau đây không phải là mục tiêu của HDFS?",
                options: ["Phát hiện lỗi và khôi phục", "Xử lý tập dữ liệu khổng lồ", "Ngăn chặn việc xóa dữ liệu", "Cung cấp băng thông mạng cao để di chuyển dữ liệu"],
                correctAnswer: "Ngăn chặn việc xóa dữ liệu",
                source: [138]
            },
            {
                question: "YARN là viết tắt của",
                options: ["Yahoo's another resource name", "Yet another resource negotiator", "Yahoo's archived Resource names", "Yet another resource need."],
                correctAnswer: "Yet another resource negotiator",
                source: [139]
            },
            {
                question: "Kiến trúc HDFS trong Hadoop có nguồn gốc là",
                options: ["Hệ thống tệp phân phối của Google", "Hệ thống tệp phân tán của Yahoo", "Hệ thống tệp phân tán của Facebook", "Hệ thống tệp phân tán của Azure"],
                correctAnswer: "Hệ thống tệp phân phối của Google",
                source: [140]
            }
        ];

        let currentQuizData = []; // This will hold the shuffled questions for the current quiz session
        let currentQuestionIndex = 0;
        let userAnswers = {}; // { questionIndex: { selectedAnswer: 'value', isCorrect: true/false } }
        let autoAdvanceTimeout;
        const AUTO_ADVANCE_DELAY = 3000; // 3 seconds delay

        // Utility function to shuffle an array
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // Function to load and display a question
        function loadQuestion(index) {
            clearTimeout(autoAdvanceTimeout); // Clear any pending auto-advance

            const questionContainer = document.getElementById('questionContainer');
            questionContainer.innerHTML = ''; // Clear previous question content

            const q = currentQuizData[index];
            if (!q) {
                showResults();
                return;
            }

            const questionDiv = document.createElement('div');
            questionDiv.classList.add('quiz-section');
            questionDiv.innerHTML = `<h3>Câu ${index + 1}/${currentQuizData.length}: ${q.question}</h3>`;

            const optionsDiv = document.createElement('div');
            optionsDiv.classList.add('options');

            let shuffledOptions = [...q.options];
            shuffleArray(shuffledOptions); // Shuffle options for the current question

            shuffledOptions.forEach((option) => {
                const label = document.createElement('label');
                label.innerHTML = `
                    <input type="radio" name="currentQuestion" value="${option}" onchange="handleAnswerSelection(this)">
                    ${option}
                `;
                optionsDiv.appendChild(label);
            });

            const feedbackDiv = document.createElement('div');
            feedbackDiv.classList.add('feedback');
            feedbackDiv.id = `feedbackCurrent`;

            questionDiv.appendChild(optionsDiv);
            questionDiv.appendChild(feedbackDiv);
            questionContainer.appendChild(questionDiv);

            // If question has been answered before, restore selection and feedback
            if (userAnswers[index]) {
                const radios = document.getElementsByName('currentQuestion');
                radios.forEach(radio => {
                    if (radio.value === userAnswers[index].selectedAnswer) {
                        radio.checked = true;
                    }
                });
                checkAnswer(userAnswers[index].selectedAnswer, true); // Re-apply feedback
            }

            updateNavigationButtons();
            window.scrollTo(0, 0); // Scroll to top of the page
        }

        // Handles user selecting an answer
        function handleAnswerSelection(selectedRadio) {
            const selectedValue = selectedRadio.value;
            
            // Prevent re-checking if already answered and feedback shown
            if (userAnswers[currentQuestionIndex] && userAnswers[currentQuestionIndex].selectedAnswer) {
                return; 
            }

            checkAnswer(selectedValue);

            // Set timeout to auto-advance to next question
            autoAdvanceTimeout = setTimeout(() => {
                if (currentQuestionIndex < currentQuizData.length - 1) {
                    showNextQuestion();
                } else {
                    showResults(); // If it's the last question, show results
                }
            }, AUTO_ADVANCE_DELAY);
        }

        // Checks the answer and updates UI
        function checkAnswer(selectedValue, isRecheck = false) {
            const questionData = currentQuizData[currentQuestionIndex];
            const feedbackElement = document.getElementById(`feedbackCurrent`);
            const radios = document.getElementsByName(`currentQuestion`);

            // Disable all radio buttons
            radios.forEach(radio => {
                radio.disabled = true;
                const label = radio.closest('label');
                if (label) {
                    label.classList.add('disabled');
                }
            });

            // Mark correct/incorrect options
            let isCorrect = false;
            radios.forEach(radio => {
                const label = radio.closest('label');
                if (radio.value === questionData.correctAnswer) {
                    label.classList.add('correct-answer');
                } else if (radio.checked) {
                    label.classList.add('incorrect-answer');
                }
            });

            if (selectedValue === questionData.correctAnswer) {
                feedbackElement.innerHTML = '<i class="fas fa-check-circle"></i> Chính xác!';
                feedbackElement.classList.remove('incorrect');
                feedbackElement.classList.add('correct');
                isCorrect = true;
            } else {
                feedbackElement.innerHTML = `<i class="fas fa-times-circle"></i> Sai rồi! Đáp án đúng là: ${questionData.correctAnswer}`;
                feedbackElement.classList.remove('correct');
                feedbackElement.classList.add('incorrect');
            }

            // Store user's answer and correctness only if not a recheck
            if (!isRecheck) {
                userAnswers[currentQuestionIndex] = {
                    selectedAnswer: selectedValue,
                    isCorrect: isCorrect
                };
            }
        }

        // Updates state of navigation buttons (Prev/Next)
        function updateNavigationButtons() {
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            if (currentQuestionIndex === currentQuizData.length - 1) {
                document.getElementById('nextBtn').innerHTML = 'Xem kết quả <i class="fas fa-poll"></i>';
                document.getElementById('nextBtn').disabled = false; // Always enabled for results
            } else {
                document.getElementById('nextBtn').innerHTML = 'Câu tiếp theo <i class="fas fa-arrow-right"></i>';
                // Only enable next if current question has been answered
                document.getElementById('nextBtn').disabled = !userAnswers[currentQuestionIndex];
            }
        }

        // Shows the next question
        function showNextQuestion() {
            clearTimeout(autoAdvanceTimeout); // Clear any pending auto-advance

            if (currentQuestionIndex < currentQuizData.length - 1) {
                currentQuestionIndex++;
                loadQuestion(currentQuestionIndex);
            } else {
                showResults(); // If already on last question, clicking Next shows results
            }
        }

        // Shows the previous question
        function showPrevQuestion() {
            clearTimeout(autoAdvanceTimeout); // Clear any pending auto-advance
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                loadQuestion(currentQuestionIndex);
            }
        }

        // Shuffles questions and starts a new quiz from the beginning
        function shuffleQuestionsAndReset() {
            currentQuizData = [...quizData]; // Create a fresh copy from original
            shuffleArray(currentQuizData);
            currentQuestionIndex = 0;
            userAnswers = {}; // Reset user answers
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('resultsScreen').style.display = 'none';
            document.getElementById('questionArea').style.display = 'block';
            loadQuestion(currentQuestionIndex);
        }

        // Resets the quiz to its initial state
        function resetQuiz() {
            currentQuizData = [...quizData]; // Restore original order and content
            currentQuestionIndex = 0;
            userAnswers = {}; // Clear all previous answers
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('resultsScreen').style.display = 'none';
            document.getElementById('questionArea').style.display = 'block';
            loadQuestion(currentQuestionIndex);
        }

        // Shows the results screen
        function showResults() {
            document.getElementById('questionArea').style.display = 'none';
            document.getElementById('resultsScreen').style.display = 'block';

            let correctCount = 0;
            // Iterate through original quizData indices to count results
            for (let i = 0; i < quizData.length; i++) {
                // Find the index of this original question in the currentQuizData (shuffled)
                const originalQuestion = quizData[i];
                const shuffledIndex = currentQuizData.findIndex(q => q.question === originalQuestion.question);
                
                if (userAnswers[shuffledIndex] && userAnswers[shuffledIndex].isCorrect) {
                    correctCount++;
                }
            }
            
            const totalQuestions = quizData.length; // Always base on total original questions
            const incorrectCount = totalQuestions - correctCount;

            document.getElementById('totalQuestionsResult').textContent = totalQuestions;
            document.getElementById('correctAnswersCount').textContent = correctCount;
            document.getElementById('incorrectAnswersCount').textContent = incorrectCount;

            window.scrollTo(0, 0); // Scroll to top to see results
        }

        // Event listener for starting the quiz
        document.getElementById('startQuizBtn').addEventListener('click', () => {
            shuffleQuestionsAndReset(); // Start by shuffling and loading the first question
        });

        // Initial setup when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            // Nothing to do here for initial load as start screen is default.
            // Quiz starts when 'startQuizBtn' is clicked.
        });
    </script>
</body>
</html>
